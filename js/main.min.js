$(function() {
  "use strict";

  /* Show the next slide of the slideshow. */
  function animate() {
    var $activeSlide = $(".active"),
      $nextSlide = ($activeSlide.next().length > 0) ? $activeSlide.next() : $("#slides .slide:first"),
      timeline = new TimelineLite({ onComplete: onComplete, onCompleteParams: ["{self}", $activeSlide, $nextSlide], delay: 1 });

    // Create the timeline animation.
    timeline.set($nextSlide, { css: { zIndex: 3 } })
      .to($activeSlide.find(".description"), 3, { left: "12vw", autoAlpha: 1, z: 0.1 })
      .to($activeSlide.find(".sub-description"), 3, { left: "12vw", autoAlpha: 1, z: 0.1 }, "-=1.5")
      // TODO: Grayscale won't work in IE.
      // .to($activeSlide, 3, { onUpdate: tweenGrayscale, onUpdateParams: ["{self}", 100, 0] }, "-=3")
      .to($activeSlide.find(".rectangle"), 2, { right: "4vw", z: 0.1 })
      .fromTo($nextSlide, 2, { left: "100vw" }, { left: "0vw", z: 0.1 }, "+=7");
  }

  /* Fired when the timeline has completed. */
  function onComplete(timeline, $previousSlide, $activeSlide) {
    $activeSlide.css("z-index", 2).addClass("active");

    resetSlide(timeline, $previousSlide);
    animate();
  }

  /* Reset the previous slide. */
  function resetSlide(timeline, $slide) {
    timeline.set($slide, { css: { zIndex: 1 } })
      .set($slide.find(".description"), { css: { left: "0vw", autoAlpha: 0 } })
      .set($slide.find(".sub-description"), { css: { left: "0vw", autoAlpha: 0 } })
      .set($slide, { "-webkit-filter": "grayscale(100%)", filter: "grayscale(100%)" })
      .set($slide.find(".rectangle"), { css: { right: -$slide.find(".rectangle").width() } });

    $slide.removeClass("active");
  }

  /* Tween the grayscale value. */
  function tweenGrayscale(timeline, start, end) {
    var progress = Math.floor(timeline.progress() * 100),
      value = start - progress;

    TweenLite.set(timeline.target, { "-webkit-filter": "grayscale(" + value + "%)", filter: "grayscale(" + value + "%)" });
  }

  function init() {
    // Workaround for being unable to set the position of the rectangles in CSS as it breaks mobile.
    $(".rectangle").each(function() {
      $(this).css("right", -$(this).width()).show();
    });

    animate();
  }

  init();

});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIiQoZnVuY3Rpb24oKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIC8qIFNob3cgdGhlIG5leHQgc2xpZGUgb2YgdGhlIHNsaWRlc2hvdy4gKi9cbiAgZnVuY3Rpb24gYW5pbWF0ZSgpIHtcbiAgICB2YXIgJGFjdGl2ZVNsaWRlID0gJChcIi5hY3RpdmVcIiksXG4gICAgICAkbmV4dFNsaWRlID0gKCRhY3RpdmVTbGlkZS5uZXh0KCkubGVuZ3RoID4gMCkgPyAkYWN0aXZlU2xpZGUubmV4dCgpIDogJChcIiNzbGlkZXMgLnNsaWRlOmZpcnN0XCIpLFxuICAgICAgdGltZWxpbmUgPSBuZXcgVGltZWxpbmVMaXRlKHsgb25Db21wbGV0ZTogb25Db21wbGV0ZSwgb25Db21wbGV0ZVBhcmFtczogW1wie3NlbGZ9XCIsICRhY3RpdmVTbGlkZSwgJG5leHRTbGlkZV0sIGRlbGF5OiAxIH0pO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSB0aW1lbGluZSBhbmltYXRpb24uXG4gICAgdGltZWxpbmUuc2V0KCRuZXh0U2xpZGUsIHsgY3NzOiB7IHpJbmRleDogMyB9IH0pXG4gICAgICAudG8oJGFjdGl2ZVNsaWRlLmZpbmQoXCIuZGVzY3JpcHRpb25cIiksIDMsIHsgbGVmdDogXCIxMnZ3XCIsIGF1dG9BbHBoYTogMSwgejogMC4xIH0pXG4gICAgICAudG8oJGFjdGl2ZVNsaWRlLmZpbmQoXCIuc3ViLWRlc2NyaXB0aW9uXCIpLCAzLCB7IGxlZnQ6IFwiMTJ2d1wiLCBhdXRvQWxwaGE6IDEsIHo6IDAuMSB9LCBcIi09MS41XCIpXG4gICAgICAvLyBUT0RPOiBHcmF5c2NhbGUgd29uJ3Qgd29yayBpbiBJRS5cbiAgICAgIC8vIC50bygkYWN0aXZlU2xpZGUsIDMsIHsgb25VcGRhdGU6IHR3ZWVuR3JheXNjYWxlLCBvblVwZGF0ZVBhcmFtczogW1wie3NlbGZ9XCIsIDEwMCwgMF0gfSwgXCItPTNcIilcbiAgICAgIC50bygkYWN0aXZlU2xpZGUuZmluZChcIi5yZWN0YW5nbGVcIiksIDIsIHsgcmlnaHQ6IFwiNHZ3XCIsIHo6IDAuMSB9KVxuICAgICAgLmZyb21UbygkbmV4dFNsaWRlLCAyLCB7IGxlZnQ6IFwiMTAwdndcIiB9LCB7IGxlZnQ6IFwiMHZ3XCIsIHo6IDAuMSB9LCBcIis9N1wiKTtcbiAgfVxuXG4gIC8qIEZpcmVkIHdoZW4gdGhlIHRpbWVsaW5lIGhhcyBjb21wbGV0ZWQuICovXG4gIGZ1bmN0aW9uIG9uQ29tcGxldGUodGltZWxpbmUsICRwcmV2aW91c1NsaWRlLCAkYWN0aXZlU2xpZGUpIHtcbiAgICAkYWN0aXZlU2xpZGUuY3NzKFwiei1pbmRleFwiLCAyKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuICAgIHJlc2V0U2xpZGUodGltZWxpbmUsICRwcmV2aW91c1NsaWRlKTtcbiAgICBhbmltYXRlKCk7XG4gIH1cblxuICAvKiBSZXNldCB0aGUgcHJldmlvdXMgc2xpZGUuICovXG4gIGZ1bmN0aW9uIHJlc2V0U2xpZGUodGltZWxpbmUsICRzbGlkZSkge1xuICAgIHRpbWVsaW5lLnNldCgkc2xpZGUsIHsgY3NzOiB7IHpJbmRleDogMSB9IH0pXG4gICAgICAuc2V0KCRzbGlkZS5maW5kKFwiLmRlc2NyaXB0aW9uXCIpLCB7IGNzczogeyBsZWZ0OiBcIjB2d1wiLCBhdXRvQWxwaGE6IDAgfSB9KVxuICAgICAgLnNldCgkc2xpZGUuZmluZChcIi5zdWItZGVzY3JpcHRpb25cIiksIHsgY3NzOiB7IGxlZnQ6IFwiMHZ3XCIsIGF1dG9BbHBoYTogMCB9IH0pXG4gICAgICAuc2V0KCRzbGlkZSwgeyBcIi13ZWJraXQtZmlsdGVyXCI6IFwiZ3JheXNjYWxlKDEwMCUpXCIsIGZpbHRlcjogXCJncmF5c2NhbGUoMTAwJSlcIiB9KVxuICAgICAgLnNldCgkc2xpZGUuZmluZChcIi5yZWN0YW5nbGVcIiksIHsgY3NzOiB7IHJpZ2h0OiAtJHNsaWRlLmZpbmQoXCIucmVjdGFuZ2xlXCIpLndpZHRoKCkgfSB9KTtcblxuICAgICRzbGlkZS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgfVxuXG4gIC8qIFR3ZWVuIHRoZSBncmF5c2NhbGUgdmFsdWUuICovXG4gIGZ1bmN0aW9uIHR3ZWVuR3JheXNjYWxlKHRpbWVsaW5lLCBzdGFydCwgZW5kKSB7XG4gICAgdmFyIHByb2dyZXNzID0gTWF0aC5mbG9vcih0aW1lbGluZS5wcm9ncmVzcygpICogMTAwKSxcbiAgICAgIHZhbHVlID0gc3RhcnQgLSBwcm9ncmVzcztcblxuICAgIFR3ZWVuTGl0ZS5zZXQodGltZWxpbmUudGFyZ2V0LCB7IFwiLXdlYmtpdC1maWx0ZXJcIjogXCJncmF5c2NhbGUoXCIgKyB2YWx1ZSArIFwiJSlcIiwgZmlsdGVyOiBcImdyYXlzY2FsZShcIiArIHZhbHVlICsgXCIlKVwiIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAvLyBXb3JrYXJvdW5kIGZvciBiZWluZyB1bmFibGUgdG8gc2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgcmVjdGFuZ2xlcyBpbiBDU1MgYXMgaXQgYnJlYWtzIG1vYmlsZS5cbiAgICAkKFwiLnJlY3RhbmdsZVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgJCh0aGlzKS5jc3MoXCJyaWdodFwiLCAtJCh0aGlzKS53aWR0aCgpKS5zaG93KCk7XG4gICAgfSk7XG5cbiAgICBhbmltYXRlKCk7XG4gIH1cblxuICBpbml0KCk7XG5cbn0pO1xuIl0sImZpbGUiOiJtYWluLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
